#!/usr/bin/env python3
"""
Demo script showing Hronir AI agent capabilities.
"""

import os
import time

from rich.console import Console
from rich.panel import Panel
from rich.progress import track
from rich.text import Text

console = Console()

def show_intro():
    """Show introduction to the demo."""
    Text("ğŸ­ Hronir Encyclopedia AI Agent Demo", style="bold blue")

    intro_text = """
Welcome to the Hronir Encyclopedia AI Agent System!

This demonstration showcases autonomous AI agents that can:
â€¢ Generate Borgesian-style hrÃ¶nir chapters
â€¢ Compete with each other for narrative supremacy
â€¢ Judge and evaluate competing narratives
â€¢ Participate in the literary protocol

The agents use Google Gemini for content generation and follow the
philosophical and competitive principles of the Hronir Encyclopedia.
"""

    console.print(Panel(intro_text, title="ğŸ­ Hronir AI Agents", border_style="blue"))
    console.print()

def show_agent_capabilities():
    """Show what the agents can do."""

    capabilities = [
        "ğŸ–‹ï¸  **Chapter Writer Agent**: Creates new hrÃ¶nir chapters in Borgesian style",
        "âš–ï¸  **Judge Agent**: Evaluates competing narratives and makes decisions",
        "ğŸ¯ **Competitive Mode**: Agents compete to create the most compelling content",
        "ğŸ”„ **Batch Processing**: Generate multiple chapters efficiently",
        "ğŸ“Š **Quality Metrics**: Evaluate narrative consistency and literary merit",
        "ğŸ§  **Strategic Thinking**: Adapt writing style based on competitive context"
    ]

    console.print(Panel("\n".join(capabilities), title="ğŸš€ Agent Capabilities", border_style="green"))
    console.print()

def show_working_commands():
    """Show the working CLI commands."""

    working_commands = [
        "âœ… `uv run hronir agent status` - Check system status",
        "âœ… `uv run hronir agent test-writer` - Test chapter generation",
        "âœ… `uv run hronir agent test-writer --theme 'philosophical_maze'` - Themed generation",
        "âœ… `uv run hronir agent test-writer --position 1 --predecessor-uuid <uuid>` - Continue narrative",
        "ğŸ”§ `uv run hronir agent competitive-session` - Multi-agent competition (in development)",
        "ğŸ”§ `uv run hronir agent test-crew` - CrewAI integration (in development)"
    ]

    console.print(Panel("\n".join(working_commands), title="ğŸ® Available Commands", border_style="yellow"))
    console.print()

def show_example_output():
    """Show example of generated content."""

    example_content = """
**Do Limiar InominÃ¡vel**

Ã‰ um equÃ­voco comum, mesmo entre os mais assÃ­duos leitores da EnciclopÃ©dia
Hronir, supor a existÃªncia de um *inÃ­cio* tangÃ­vel. A mente humana, prisioneira
de uma linearidade inexorÃ¡vel, procura sempre o primeiro degrau da escada
infinita, o alfa de um alfabeto que nÃ£o conhece Ã´mega.

Contudo, a EnciclopÃ©dia nÃ£o se inicia; ela *irrompe*. Como uma flor impossÃ­vel
que desabrocha simultaneamente em todos os jardins de todos os mundos possÃ­veis,
cada artigo surge jÃ¡ impregnado da totalidade do conhecimento que ainda nÃ£o foi
escrito. O leitor atento perceberÃ¡ que cada pÃ¡gina contÃ©m, em estado latente,
todas as outras pÃ¡ginas...

[Generated by Chapter Writer Agent]
UUID: 9f3d7886-30ac-5cdd-8763-8282b6bce754
Consistency Score: 0.80
Length: 2,314 characters
"""

    console.print(Panel(example_content, title="ğŸ“– Example Generated Content", border_style="magenta"))
    console.print()

def show_technical_details():
    """Show technical implementation details."""

    tech_details = """
ğŸ”§ **Technical Architecture**:
â€¢ Google Gemini API for content generation
â€¢ DuckDB for persistent storage
â€¢ Pydantic models for data validation
â€¢ CrewAI framework for multi-agent coordination
â€¢ Rich CLI for interactive demonstrations

ğŸ§  **AI Integration**:
â€¢ Prompt engineering for Borgesian style
â€¢ Narrative consistency scoring
â€¢ Competitive strategy adaptation
â€¢ Batch processing capabilities

ğŸ¯ **Literary Protocol**:
â€¢ Content-addressed UUID system
â€¢ Elo ranking for competitive evaluation
â€¢ Temporal cascade for canonical path updates
â€¢ Game-theoretic agent interactions
"""

    console.print(Panel(tech_details, title="âš™ï¸ Technical Implementation", border_style="cyan"))
    console.print()

def show_next_steps():
    """Show what to do next."""

    next_steps = """
ğŸš€ **Try the System**:
1. Run `uv run hronir agent status` to check system readiness
2. Generate your first chapter with `uv run hronir agent test-writer`
3. Experiment with different themes and positions
4. View the generated content in the Hronir Encyclopedia

ğŸ”¬ **Experiment Further**:
â€¢ Try different themes: 'metaphysical_maze', 'temporal_paradox', 'infinite_library'
â€¢ Generate sequential chapters by using predecessor UUIDs
â€¢ Compare outputs from different agent configurations
â€¢ Explore the competitive dynamics between agents

ğŸ“š **Learn More**:
â€¢ Read the CLAUDE.md file for development guidelines
â€¢ Check the Protocol v2 documentation
â€¢ Explore the existing test suite for usage patterns
"""

    console.print(Panel(next_steps, title="ğŸ¯ Next Steps", border_style="bright_green"))
    console.print()

def simulate_agent_interaction():
    """Simulate an agent interaction for demo purposes."""

    console.print("ğŸ¬ [bold]Simulating Agent Interaction[/bold]")
    console.print()

    # Simulate agent thinking
    steps = [
        "ğŸ§  Agent analyzing narrative context...",
        "ğŸ“ Generating Borgesian prose...",
        "ğŸ­ Applying philosophical themes...",
        "âš–ï¸ Evaluating narrative consistency...",
        "âœ¨ Finalizing hrÃ¶nir chapter..."
    ]

    for step in track(steps, description="Agent Processing"):
        time.sleep(0.5)  # Simulate processing time

    console.print("âœ… [bold green]Agent task completed successfully![/bold green]")
    console.print()

def main():
    """Main demo function."""

    # Check if API key is set
    if not os.getenv("GEMINI_API_KEY"):
        console.print(Panel(
            "âš ï¸ GEMINI_API_KEY not set. Please configure it to run the actual agents:\n\n"
            "export GEMINI_API_KEY='your-api-key-here'",
            title="âš ï¸ Configuration Required",
            border_style="yellow"
        ))
        console.print()

    show_intro()
    show_agent_capabilities()
    show_working_commands()
    show_example_output()
    show_technical_details()
    simulate_agent_interaction()
    show_next_steps()

    console.print("ğŸ‰ [bold]Demo completed![/bold] The Hronir AI Agent System is ready for experimentation.")
    console.print()

if __name__ == "__main__":
    main()
